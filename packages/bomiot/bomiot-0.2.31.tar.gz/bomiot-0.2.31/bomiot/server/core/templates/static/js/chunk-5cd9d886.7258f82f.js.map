{"version":3,"sources":["webpack:///./src/views/project/Edit.vue?2193","webpack:///./src/views/project/Edit.vue?0abd","webpack:///src/views/project/Edit.vue","webpack:///./src/views/project/Edit.vue?f9ad","webpack:///./src/views/project/Edit.vue?7b2d"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","projectName","tree","defaultProps","on","onNodeClick","basename","activeFile","onRenameFile","_v","_s","$lang","buttons","rename","_e","onCreateFile","create","onDeleteFile","delete","editorOptions","onEditorCodeChange","model","value","callback","$$v","code","expression","staticRenderFns","name","data","clientData","loading","children","label","activeNode","modeMap","py","js","html","vue","md","scss","css","php","tabSize","mode","theme","lineNumbers","styleActiveLine","line","keyMap","extraKeys","Tab","foldGutter","gutters","styleSelectedText","highlightSelectionMatches","showToken","annotateScrollbar","components","PanelTitle","codemirror","created","getProjectTree","methods","$http","get","then","catch","onChangeCode","join","path","extension","post","$prompt","confirmButtonText","cancelButtonText","inputValue","inputPattern","inputErrorMessage","pre","new","$confirm","type","component"],"mappings":"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","file":"static/js/chunk-5cd9d886.7258f82f.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Edit.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-row',[_c('el-col',{attrs:{\"span\":4}},[_c('div',{staticClass:\"panel\",attrs:{\"id\":\"tree\"}},[_c('panel-title',{attrs:{\"title\":_vm.projectName}}),_c('div',{staticClass:\"panel-body\"},[_c('el-tree',{attrs:{\"data\":_vm.tree,\"props\":_vm.defaultProps},on:{\"node-click\":_vm.onNodeClick}})],1)],1)]),_c('el-col',{attrs:{\"span\":20}},[_c('div',{staticClass:\"panel m-l-md\"},[_c('panel-title',{attrs:{\"title\":_vm.basename(_vm.activeFile)}},[(_vm.activeFile)?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":_vm.onRenameFile}},[_c('i',{staticClass:\"fa fa-edit\"}),_vm._v(\"\\n          \"+_vm._s(_vm.$lang.buttons.rename)+\"\\n        \")]):_vm._e(),(_vm.activeFile)?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"info\"},on:{\"click\":_vm.onCreateFile}},[_c('i',{staticClass:\"fa fa-plus\"}),_vm._v(\"\\n          \"+_vm._s(_vm.$lang.buttons.create)+\"\\n        \")]):_vm._e(),(_vm.activeFile)?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":_vm.onDeleteFile}},[_c('i',{staticClass:\"fa fa-close\"}),_vm._v(\"\\n          \"+_vm._s(_vm.$lang.buttons.delete)+\"\\n        \")]):_vm._e()],1),_c('div',{staticClass:\"panel-body\"},[_c('codemirror',{attrs:{\"options\":_vm.editorOptions},on:{\"input\":_vm.onEditorCodeChange},model:{value:(_vm.code),callback:function ($$v) {_vm.code=$$v},expression:\"code\"}})],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-row>\n    <el-col :span=\"4\">\n      <div class=\"panel\" id=\"tree\">\n        <panel-title :title=\"projectName\"> </panel-title>\n        <div class=\"panel-body\">\n          <el-tree\n            :data=\"tree\"\n            :props=\"defaultProps\"\n            @node-click=\"onNodeClick\"\n          ></el-tree>\n        </div>\n      </div>\n    </el-col>\n    <el-col :span=\"20\">\n      <div class=\"panel m-l-md\">\n        <panel-title :title=\"basename(activeFile)\">\n          <el-button\n            @click=\"onRenameFile\"\n            size=\"mini\"\n            type=\"primary\"\n            v-if=\"activeFile\"\n          >\n            <i class=\"fa fa-edit\"></i>\n            {{ $lang.buttons.rename }}\n          </el-button>\n          <el-button\n            @click=\"onCreateFile\"\n            size=\"mini\"\n            type=\"info\"\n            v-if=\"activeFile\"\n          >\n            <i class=\"fa fa-plus\"></i>\n            {{ $lang.buttons.create }}\n          </el-button>\n          <el-button\n            @click=\"onDeleteFile\"\n            size=\"mini\"\n            type=\"danger\"\n            v-if=\"activeFile\"\n          >\n            <i class=\"fa fa-close\"></i>\n            {{ $lang.buttons.delete }}\n          </el-button>\n        </panel-title>\n        <div class=\"panel-body\">\n          <codemirror\n            v-model=\"code\"\n            :options=\"editorOptions\"\n            @input=\"onEditorCodeChange\"\n          >\n          </codemirror>\n        </div>\n      </div>\n    </el-col>\n  </el-row>\n</template>\n<script>\nimport PanelTitle from \"../../components/PanelTitle\";\nimport { codemirror } from \"vue-codemirror\";\n\n// Theme\nimport \"codemirror/theme/monokai.css\";\n\n// Base Style\nimport \"codemirror/lib/codemirror.css\";\n\n// Extra Keys\nimport \"codemirror/addon/hint/show-hint\";\nimport \"codemirror/addon/hint/javascript-hint\";\nimport \"codemirror/addon/hint/sql-hint\";\nimport \"codemirror/addon/hint/html-hint\";\nimport \"codemirror/addon/hint/xml-hint\";\nimport \"codemirror/addon/hint/anyword-hint\";\nimport \"codemirror/addon/hint/css-hint\";\nimport \"codemirror/addon/hint/show-hint\";\n\n// Key Map\nimport \"codemirror/keymap/sublime\";\n\n// CloseBrackets\nimport \"codemirror/addon/edit/closebrackets\";\n\n// Active Line\nimport \"codemirror/addon/selection/active-line\";\n\n// StyleSelectedText\nimport \"codemirror/addon/selection/mark-selection\";\nimport \"codemirror/addon/search/searchcursor\";\n\n// Hint\nimport \"codemirror/addon/hint/show-hint\";\nimport \"codemirror/addon/hint/show-hint.css\";\nimport \"codemirror/addon/hint/anyword-hint\";\n\n// foldGutter\nimport \"codemirror/addon/fold/foldgutter.css\";\nimport \"codemirror/addon/fold/brace-fold\";\nimport \"codemirror/addon/fold/comment-fold\";\nimport \"codemirror/addon/fold/foldcode\";\nimport \"codemirror/addon/fold/foldgutter\";\nimport \"codemirror/addon/fold/indent-fold\";\nimport \"codemirror/addon/fold/markdown-fold\";\nimport \"codemirror/addon/fold/xml-fold\";\n\n// Mode\nimport \"codemirror/mode/css/css\";\nimport \"codemirror/mode/dockerfile/dockerfile\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/markdown/markdown\";\nimport \"codemirror/mode/php/php\";\nimport \"codemirror/mode/python/python\";\nimport \"codemirror/mode/sass/sass\";\nimport \"codemirror/mode/javascript/javascript\";\nimport \"codemirror/mode/sql/sql\";\nimport \"codemirror/mode/vue/vue\";\n\nexport default {\n  name: \"projectEdit\",\n  data() {\n    return {\n      projectName: this.$route.params.name,\n      clientData: null,\n      loading: true,\n      tree: [],\n      defaultProps: {\n        children: \"children\",\n        label: \"label\",\n      },\n      activeFile: null,\n      activeNode: null,\n      code: \"Please Choose File from Left to Edit.\",\n      modeMap: {\n        py: \"text/x-python\",\n        js: \"text/javascript\",\n        html: \"text/html\",\n        vue: \"text/x-vue\",\n        md: \"text/x-markdown\",\n        scss: \"text/x-sass\",\n        css: \"text/x-css\",\n        php: \"application/x-httpd-php\",\n      },\n      editorOptions: {\n        tabSize: 4,\n        mode: \"text/javascript\",\n        theme: \"monokai\",\n        lineNumbers: true,\n        styleActiveLine: true,\n        line: true,\n        keyMap: \"sublime\",\n        // 按键映射，比如Ctrl键映射autocomplete，autocomplete是hint代码提示事件\n        extraKeys: {\n          Tab: \"autocomplete\",\n        },\n        // 代码折叠\n        foldGutter: true,\n        gutters: [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"],\n        // 选中文本自动高亮，及高亮方式\n        styleSelectedText: true,\n        highlightSelectionMatches: {\n          showToken: /\\w/,\n          annotateScrollbar: true,\n        },\n      },\n    };\n  },\n  components: {\n    PanelTitle,\n    codemirror,\n  },\n  created() {\n    this.getProjectTree(this.projectName);\n  },\n  methods: {\n    getProjectTree(name) {\n      // 获取目录树\n      this.$http\n        .get(\n          this.formatString(this.$store.state.url.project.tree, {\n            name: name,\n          })\n        )\n        .then(({ data: tree }) => {\n          this.tree = tree;\n          if (this.tree.length > 0) {\n            let lastNode = this.tree[this.tree.length - 1];\n            this.onNodeClick(lastNode);\n          }\n        })\n        .catch(() => {\n          this.$message.error(this.$store.getters.$lang.messages.errorLoad);\n        });\n    },\n    onNodeClick(data) {\n      this.activeNode = data;\n      this.onChangeCode(data);\n      this.activeFile = this.join(this.activeNode.path, this.activeNode.label);\n    },\n    // 呈现代码\n    onChangeCode(data) {\n      // 获取后缀\n      let group = this.activeNode.label.split(\".\");\n      let extension = group[group.length - 1];\n      // 设置Mode\n      this.editorOptions.mode = this.modeMap[extension];\n      // 加载文件\n      if (!data.children) {\n        this.$http\n          .post(this.$store.state.url.project.fileRead, data)\n          .then(({ data: code }) => {\n            this.code = code;\n          })\n          .catch(() => {\n            this.$message.error(this.$store.getters.$lang.messages.errorLoad);\n          });\n      }\n    },\n    onRenameFile() {\n      this.$prompt(\n        this.$store.getters.$lang.titles.renameFile,\n        this.$store.getters.$lang.buttons.confirm,\n        {\n          confirmButtonText: this.$store.getters.$lang.buttons.yes,\n          cancelButtonText: this.$store.getters.$lang.buttons.no,\n          inputValue: this.activeNode.label,\n          inputPattern: /[^/\\s]/,\n          inputErrorMessage: this.$store.getters.$lang.messages.errorFormat,\n        }\n      ).then(({ value }) => {\n        this.$http\n          .post(this.$store.state.url.project.fileRename, {\n            path: this.activeNode.path,\n            pre: this.activeNode.label,\n            new: value,\n          })\n          .then(() => {\n            this.$message.success(\n              this.$store.getters.$lang.messages.successSave\n            );\n            this.getProjectTree(this.projectName);\n          })\n          .catch(() => {\n            this.$message.error(this.$store.getters.$lang.messages.errorSave);\n          });\n      });\n    },\n    onCreateFile() {\n      this.$prompt(\n        this.$store.getters.$lang.titles.createFile,\n        this.$store.getters.$lang.buttons.confirm,\n        {\n          confirmButtonText: this.$store.getters.$lang.buttons.yes,\n          cancelButtonText: this.$store.getters.$lang.buttons.no,\n          inputValue: this.activeNode.label,\n          inputPattern: /[^/\\s]/,\n          inputErrorMessage: this.$store.getters.$lang.messages.errorFormat,\n        }\n      ).then(({ value }) => {\n        this.$http\n          .post(this.$store.state.url.project.fileCreate, {\n            path: this.activeNode.path,\n            name: value,\n          })\n          .then(() => {\n            this.$message.success(\n              this.$store.getters.$lang.messages.successSave\n            );\n            this.getProjectTree(this.projectName);\n          })\n          .catch(() => {\n            this.$message.error(this.$store.getters.$lang.messages.errorSave);\n          });\n      });\n    },\n    onDeleteFile() {\n      this.$confirm(\n        this.$store.getters.$lang.messages.confirm,\n        this.$store.getters.$lang.buttons.confirm,\n        {\n          confirmButtonText: this.$store.getters.$lang.buttons.yes,\n          cancelButtonText: this.$store.getters.$lang.buttons.no,\n          type: \"warning\",\n        }\n      ).then(() => {\n        this.$http\n          .post(this.$store.state.url.project.fileDelete, {\n            path: this.activeNode.path,\n            label: this.activeNode.label,\n          })\n          .then(() => {\n            this.$message.success(\n              this.$store.getters.$lang.messages.successDelete\n            );\n            this.getProjectTree(this.projectName);\n          })\n          .catch(() => {\n            this.$message.error(this.$store.getters.$lang.messages.errorDelete);\n          });\n      });\n    },\n    onEditorCodeChange(code, callback) {\n      this.$http\n        .post(this.$store.state.url.project.fileUpdate, {\n          code: code,\n          path: this.activeNode[\"path\"],\n          label: this.activeNode[\"label\"],\n        })\n        .then(() => {\n          if (callback) {\n            callback();\n          }\n        })\n        .catch(() => {\n          this.$message.error(this.$store.getters.$lang.messages.errorDelete);\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.CodeMirror {\n  font-size: 16px;\n  height: 76vh;\n  z-index: 0;\n}\n\n#tree {\n  .panel-body {\n    overflow: hidden;\n  }\n  .el-tree {\n    overflow-x: scroll;\n    height: 76vh;\n    border: none;\n    div[role=\"treeitem\"] {\n      .el-tree-node__content {\n        height: 35px;\n      }\n    }\n  }\n}\n\n.el-tree-node.is-current {\n  background: #eee;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Edit.vue?vue&type=template&id=547e4f38&\"\nimport script from \"./Edit.vue?vue&type=script&lang=js&\"\nexport * from \"./Edit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Edit.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}