{"version":3,"file":"FileUpload-XIx4GShl.js","sources":["../../../file/dist/shared/utils.js","../../../file/dist/shared/FilePreview.svelte","../../../file/dist/shared/File.svelte","../../../file/dist/shared/FileUpload.svelte"],"sourcesContent":["export const prettyBytes = (bytes) => {\n    let units = [\"B\", \"KB\", \"MB\", \"GB\", \"PB\"];\n    let i = 0;\n    while (bytes > 1024) {\n        bytes /= 1024;\n        i++;\n    }\n    let unit = units[i];\n    return bytes.toFixed(1) + \"&nbsp;\" + unit;\n};\n","<script>import { prettyBytes } from \"./utils\";\nimport { createEventDispatcher } from \"svelte\";\nimport { DownloadLink } from \"@gradio/wasm/svelte\";\nconst dispatch = createEventDispatcher();\nexport let value;\nexport let selectable = false;\nexport let height = void 0;\nexport let i18n;\nfunction split_filename(filename) {\n  const last_dot = filename.lastIndexOf(\".\");\n  if (last_dot === -1) {\n    return [filename, \"\"];\n  }\n  return [filename.slice(0, last_dot), filename.slice(last_dot)];\n}\n$:\n  normalized_files = (Array.isArray(value) ? value : [value]).map((file) => {\n    const [filename_stem, filename_ext] = split_filename(file.orig_name ?? \"\");\n    return {\n      ...file,\n      filename_stem,\n      filename_ext\n    };\n  });\nfunction handle_row_click(event, index) {\n  const tr = event.currentTarget;\n  const should_select = event.target === tr || // Only select if the click is on the row itself\n  tr && tr.firstElementChild && event.composedPath().includes(tr.firstElementChild);\n  if (should_select) {\n    dispatch(\"select\", { value: normalized_files[index].orig_name, index });\n  }\n}\nfunction remove_file(index) {\n  const removed = normalized_files.splice(index, 1);\n  normalized_files = [...normalized_files];\n  value = normalized_files;\n  dispatch(\"delete\", removed[0]);\n  dispatch(\"change\", normalized_files);\n}\nconst is_browser = typeof window !== \"undefined\";\n</script>\n\n<div\n\tclass=\"file-preview-holder\"\n\tstyle=\"max-height: {typeof height === undefined ? 'auto' : height + 'px'};\"\n>\n\t<table class=\"file-preview\">\n\t\t<tbody>\n\t\t\t{#each normalized_files as file, i (file)}\n\t\t\t\t<tr\n\t\t\t\t\tclass=\"file\"\n\t\t\t\t\tclass:selectable\n\t\t\t\t\ton:click={(event) => {\n\t\t\t\t\t\thandle_row_click(event, i);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<td class=\"filename\" aria-label={file.orig_name}>\n\t\t\t\t\t\t<span class=\"stem\">{file.filename_stem}</span>\n\t\t\t\t\t\t<span class=\"ext\">{file.filename_ext}</span>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td class=\"download\">\n\t\t\t\t\t\t{#if file.url}\n\t\t\t\t\t\t\t<DownloadLink\n\t\t\t\t\t\t\t\thref={file.url}\n\t\t\t\t\t\t\t\tdownload={is_browser && window.__is_colab__\n\t\t\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t\t\t: file.orig_name}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{@html file.size != null\n\t\t\t\t\t\t\t\t\t? prettyBytes(file.size)\n\t\t\t\t\t\t\t\t\t: \"(size unknown)\"}&nbsp;&#8675;\n\t\t\t\t\t\t\t</DownloadLink>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{i18n(\"file.uploading\")}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</td>\n\n\t\t\t\t\t{#if normalized_files.length > 1}\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"label-clear-button\"\n\t\t\t\t\t\t\t\taria-label=\"Remove this file\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tremove_file(i);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:keydown={(event) => {\n\t\t\t\t\t\t\t\t\tif (event.key === \"Enter\") {\n\t\t\t\t\t\t\t\t\t\tremove_file(i);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>Ã—\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t{/if}\n\t\t\t\t</tr>\n\t\t\t{/each}\n\t\t</tbody>\n\t</table>\n</div>\n\n<style>\n\t.label-clear-button {\n\t\tcolor: var(--body-text-color-subdued);\n\t\tposition: relative;\n\t\tleft: -3px;\n\t}\n\n\t.label-clear-button:hover {\n\t\tcolor: var(--body-text-color);\n\t}\n\n\t.file-preview {\n\t\ttable-layout: fixed;\n\t\twidth: var(--size-full);\n\t\tmax-height: var(--size-60);\n\t\toverflow-y: auto;\n\t\tmargin-top: var(--size-1);\n\t\tcolor: var(--body-text-color);\n\t}\n\n\t.file-preview-holder {\n\t\toverflow: auto;\n\t}\n\n\t.file {\n\t\tdisplay: flex;\n\t\twidth: var(--size-full);\n\t}\n\n\t.file > * {\n\t\tpadding: var(--size-1) var(--size-2-5);\n\t}\n\n\t.filename {\n\t\tflex-grow: 1;\n\t\tdisplay: flex;\n\t\toverflow: hidden;\n\t}\n\t.filename .stem {\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\t.filename .ext {\n\t\twhite-space: nowrap;\n\t}\n\n\t.download {\n\t\tmin-width: 8rem;\n\t\twidth: 10%;\n\t\twhite-space: nowrap;\n\t\ttext-align: right;\n\t}\n\t.download:hover {\n\t\ttext-decoration: underline;\n\t}\n\t.download > :global(a) {\n\t\tcolor: var(--link-text-color);\n\t}\n\n\t.download > :global(a:hover) {\n\t\tcolor: var(--link-text-color-hover);\n\t}\n\t.download > :global(a:visited) {\n\t\tcolor: var(--link-text-color-visited);\n\t}\n\t.download > :global(a:active) {\n\t\tcolor: var(--link-text-color-active);\n\t}\n\t.selectable {\n\t\tcursor: pointer;\n\t}\n\n\ttbody > tr:nth-child(even) {\n\t\tbackground: var(--block-background-fill);\n\t}\n\n\ttbody > tr:nth-child(odd) {\n\t\tbackground: var(--table-odd-background-fill);\n\t}\n</style>\n","<script>import { BlockLabel, Empty } from \"@gradio/atoms\";\nimport { File } from \"@gradio/icons\";\nimport FilePreview from \"./FilePreview.svelte\";\nexport let value = null;\nexport let label;\nexport let show_label = true;\nexport let selectable = false;\nexport let height = void 0;\nexport let i18n;\n</script>\n\n<BlockLabel\n\t{show_label}\n\tfloat={value === null}\n\tIcon={File}\n\tlabel={label || \"File\"}\n/>\n\n{#if value && (Array.isArray(value) ? value.length > 0 : true)}\n\t<FilePreview {i18n} {selectable} on:select {value} {height} />\n{:else}\n\t<Empty unpadded_box={true} size=\"large\"><File /></Empty>\n{/if}\n","<script>import { createEventDispatcher, tick } from \"svelte\";\nimport { Upload, ModifyUpload } from \"@gradio/upload\";\nimport { BlockLabel } from \"@gradio/atoms\";\nimport { File } from \"@gradio/icons\";\nimport FilePreview from \"./FilePreview.svelte\";\nexport let value;\nexport let label;\nexport let show_label = true;\nexport let file_count = \"single\";\nexport let file_types = null;\nexport let selectable = false;\nexport let root;\nexport let height = void 0;\nexport let i18n;\nexport let max_file_size = null;\nexport let upload;\nexport let stream_handler;\nexport let uploading = false;\nasync function handle_upload({\n  detail\n}) {\n  value = detail;\n  await tick();\n  dispatch(\"change\", value);\n  dispatch(\"upload\", detail);\n}\nfunction handle_clear() {\n  value = null;\n  dispatch(\"change\", null);\n  dispatch(\"clear\");\n}\nconst dispatch = createEventDispatcher();\nlet dragging = false;\n$:\n  dispatch(\"drag\", dragging);\n</script>\n\n<BlockLabel {show_label} Icon={File} float={!value} label={label || \"File\"} />\n\n{#if value && (Array.isArray(value) ? value.length > 0 : true)}\n\t<ModifyUpload {i18n} on:clear={handle_clear} />\n\t<FilePreview\n\t\t{i18n}\n\t\ton:select\n\t\t{selectable}\n\t\t{value}\n\t\t{height}\n\t\ton:change\n\t\ton:delete\n\t/>\n{:else}\n\t<Upload\n\t\ton:load={handle_upload}\n\t\tfiletype={file_types}\n\t\t{file_count}\n\t\t{max_file_size}\n\t\t{root}\n\t\tbind:dragging\n\t\tbind:uploading\n\t\ton:error\n\t\t{stream_handler}\n\t\t{upload}\n\t>\n\t\t<slot />\n\t</Upload>\n{/if}\n"],"names":["prettyBytes","bytes","units","i","unit","t_value","ctx","dirty","set_data","downloadlink_changes","html_tag","raw_value","insert","target","td","anchor","append","button","t0_value","t2_value","create_if_block","attr","td0","td0_aria_label_value","tr","span0","span1","td1","current","t0","t2","set_style","div","table","tbody","split_filename","filename","last_dot","dispatch","createEventDispatcher","value","$$props","selectable","height","i18n","handle_row_click","event","index","normalized_files","remove_file","removed","$$invalidate","is_browser","file","filename_stem","filename_ext","File","show_if","blocklabel_changes","label","show_label","file_count","file_types","root","max_file_size","upload","stream_handler","uploading","handle_upload","detail","tick","handle_clear","dragging"],"mappings":"ikBAAO,MAAMA,GAAeC,GAAU,CAClC,IAAIC,EAAQ,CAAC,IAAK,KAAM,KAAM,KAAM,IAAI,EACpCC,EAAI,EACR,KAAOF,EAAQ,MACXA,GAAS,KACTE,IAEJ,IAAIC,EAAOF,EAAMC,CAAC,EAClB,OAAOF,EAAM,QAAQ,CAAC,EAAI,SAAWG,CACzC,kFCiEQ,IAAAC,EAAAC,KAAK,gBAAgB,EAAA,gDAArBC,EAAA,GAAAF,KAAAA,EAAAC,KAAK,gBAAgB,EAAA,KAAAE,EAAA,EAAAH,CAAA,2EAVf,KAAAC,MAAK,aACDA,EAAU,CAAA,GAAI,OAAO,aAC5B,KACAA,MAAK,mHAHFC,EAAA,IAAAE,EAAA,KAAAH,MAAK,sBACDA,EAAU,CAAA,GAAI,OAAO,aAC5B,KACAA,MAAK,kKAEDA,EAAI,EAAA,EAAC,MAAQ,KACjBN,GAAYM,EAAI,EAAA,EAAC,IAAI,EACrB,kBAAgB,iCAAC,IACrB,yDAHQA,EAAI,EAAA,EAAC,MAAQ,KACjBN,GAAYM,EAAI,EAAA,EAAC,IAAI,EACrB,kBAAgB,KAAAI,EAAA,EAAAC,CAAA,+SAQrBC,EAcIC,EAAAC,EAAAC,CAAA,EAbHC,EAYQF,EAAAG,CAAA,kHAnCWC,EAAAZ,MAAK,cAAa,SACnBa,EAAAb,MAAK,aAAY,8DAI/B,OAAAA,MAAK,IAAG,gCAgBTA,EAAgB,CAAA,EAAC,OAAS,GAACc,GAAAd,CAAA,+RAtBCe,EAAAC,EAAA,aAAAC,EAAAjB,MAAK,SAAS,wHAPhDM,EA8CIC,EAAAW,EAAAT,CAAA,EAvCHC,EAGIQ,EAAAF,CAAA,EAFHN,EAA6CM,EAAAG,CAAA,gBAC7CT,EAA2CM,EAAAI,CAAA,gBAG5CV,EAeIQ,EAAAG,CAAA,2FAnBiB,CAAAC,GAAArB,EAAA,IAAAW,KAAAA,EAAAZ,MAAK,cAAa,KAAAE,EAAAqB,EAAAX,CAAA,GACnB,CAAAU,GAAArB,EAAA,IAAAY,KAAAA,EAAAb,MAAK,aAAY,KAAAE,EAAAsB,EAAAX,CAAA,GAFJ,CAAAS,GAAArB,EAAA,GAAAgB,KAAAA,EAAAjB,MAAK,oKAsBjCA,EAAgB,CAAA,EAAC,OAAS,yNA9B1BA,EAAgB,CAAA,CAAA,aAAaA,EAAI,EAAA,kBAAtC,OAAIH,GAAA,EAAA,8PAJmB4B,EAAAC,EAAA,aAAA,OAAA1B,OAAW,OAAY,OAASA,KAAS,IAAI,UAFzEM,EAyDKC,EAAAmB,EAAAjB,CAAA,EArDJC,EAoDOgB,EAAAC,CAAA,EAnDNjB,EAkDOiB,EAAAC,CAAA,8EAjDC5B,EAAgB,CAAA,CAAA,0DAJEyB,EAAAC,EAAA,aAAA,OAAA1B,OAAW,OAAY,OAASA,KAAS,IAAI,+BAIpE,OAAIH,GAAA,oHAxCA,SAAAgC,GAAeC,EAAQ,CACxB,MAAAC,EAAWD,EAAS,YAAY,GAAG,EACrC,OAAAC,OACM,CAAAD,EAAU,EAAE,GAEdA,EAAS,MAAM,EAAGC,CAAQ,EAAGD,EAAS,MAAMC,CAAQ,CAAA,2BAVxD,MAAAC,EAAWC,SACN,MAAAC,CAAK,EAAAC,EACL,CAAA,WAAAC,EAAa,EAAK,EAAAD,EAClB,CAAA,OAAAE,QAAe,EAAAF,GACf,KAAAG,CAAI,EAAAH,WAiBNI,EAAiBC,EAAOC,EAAK,OAC9BvB,EAAKsB,EAAM,eACKA,EAAM,SAAWtB,GACvCA,GAAMA,EAAG,mBAAqBsB,EAAM,aAAY,EAAG,SAAStB,EAAG,iBAAiB,IAE9Ec,EAAS,SAAQ,CAAI,MAAOU,EAAiBD,CAAK,EAAE,UAAW,MAAAA,IAG1D,SAAAE,EAAYF,EAAK,CAClB,MAAAG,EAAUF,EAAiB,OAAOD,EAAO,CAAC,EAChDI,EAAA,EAAAH,MAAuBA,CAAgB,CAAA,EACvCG,EAAA,EAAAX,EAAQQ,CAAgB,EACxBV,EAAS,SAAUY,EAAQ,CAAC,CAAA,EAC5BZ,EAAS,SAAUU,CAAgB,QAE/BI,EAAU,OAAU,OAAW,UA6C5BH,EAAY9C,CAAC,QAED2C,IAAK,CACbA,EAAM,MAAQ,SACjBG,EAAY9C,CAAC,QApCP2C,IAAK,CACfD,EAAiBC,EAAO3C,CAAC,kLArC7BgD,EAAA,EAAAH,GAAoB,MAAM,QAAQR,CAAK,EAAIA,EAAS,CAAAA,CAAK,GAAG,IAAKa,GAAI,OAC5DC,EAAeC,CAAY,EAAIpB,GAAekB,EAAK,WAAa,EAAE,YAEpEA,EACH,cAAAC,EACA,aAAAC,CAAA,6fCAgB,s0BARd,MAAAjD,OAAU,UACXkD,EACC,MAAAlD,MAAS,oEAGZmD,GAAA,OAAAA,EAAA,CAAA,EAAAnD,EAAU,CAAA,IAAA,OAAM,QAAQA,EAAK,CAAA,CAAA,GAAIA,EAAK,CAAA,EAAC,OAAS,sLAL7CC,EAAA,IAAAmD,EAAA,MAAApD,OAAU,MAEVC,EAAA,IAAAmD,EAAA,MAAApD,MAAS,qSAZN,GAAA,CAAA,MAAAkC,EAAQ,IAAI,EAAAC,GACZ,MAAAkB,CAAK,EAAAlB,EACL,CAAA,WAAAmB,EAAa,EAAI,EAAAnB,EACjB,CAAA,WAAAC,EAAa,EAAK,EAAAD,EAClB,CAAA,OAAAE,QAAe,EAAAF,GACf,KAAAG,CAAI,EAAAH,m7BC6CHnC,EAAU,CAAA,wSADXA,EAAa,EAAA,CAAA,wGACZA,EAAU,CAAA,0bAbUA,EAAY,EAAA,CAAA,w0BAHbkD,SAAclD,EAAK,CAAA,EAAS,MAAAA,MAAS,oEAE/DmD,GAAA,OAAAA,EAAA,CAAA,EAAAnD,EAAU,CAAA,IAAA,OAAM,QAAQA,EAAK,CAAA,CAAA,GAAIA,EAAK,CAAA,EAAC,OAAS,qMAFRA,EAAK,CAAA,GAASC,EAAA,IAAAmD,EAAA,MAAApD,MAAS,oUAhCzD,MAAAkC,CAAK,EAAAC,GACL,MAAAkB,CAAK,EAAAlB,EACL,CAAA,WAAAmB,EAAa,EAAI,EAAAnB,EACjB,CAAA,WAAAoB,EAAa,QAAQ,EAAApB,EACrB,CAAA,WAAAqB,EAAa,IAAI,EAAArB,EACjB,CAAA,WAAAC,EAAa,EAAK,EAAAD,GAClB,KAAAsB,CAAI,EAAAtB,EACJ,CAAA,OAAAE,QAAe,EAAAF,GACf,KAAAG,CAAI,EAAAH,EACJ,CAAA,cAAAuB,EAAgB,IAAI,EAAAvB,GACpB,OAAAwB,CAAM,EAAAxB,GACN,eAAAyB,CAAc,EAAAzB,EACd,CAAA,UAAA0B,EAAY,EAAK,EAAA1B,EACb,eAAA2B,EACb,CAAA,OAAAC,GAAA,CAEAlB,EAAA,EAAAX,EAAQ6B,CAAM,QACRC,GAAI,EACVhC,EAAS,SAAUE,CAAK,EACxBF,EAAS,SAAU+B,CAAM,WAElBE,GAAY,CACnBpB,EAAA,EAAAX,EAAQ,IAAI,EACZF,EAAS,SAAU,IAAI,EACvBA,EAAS,OAAO,EAEZ,MAAAA,EAAWC,KACb,IAAAiC,EAAW,0sBAEblC,EAAS,OAAQkC,CAAQ"}