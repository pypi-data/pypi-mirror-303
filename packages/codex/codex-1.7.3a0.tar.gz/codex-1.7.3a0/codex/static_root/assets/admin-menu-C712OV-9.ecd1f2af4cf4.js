import{a1 as F,E as v,A as _,ag as L,_ as b,k as S,l as o,n as a,v as m,H as i,a as r,w as d,q as p,F as h,y as J,s as k,z as C,Z as g,bB as B,cK as M,C as y,D as A,bD as O,S as x}from"./main-Dv8e0bMI.js";import{C as R}from"./change-password-dialog-BZPmAOML.js";import{useAdminStore as I}from"./admin-Izb24SXM.js";import{d as D}from"./VSelectionControl-L41n5bnX.js";import{a as f}from"./VDivider-CuRohbVQ.js";import{n as U}from"./forwardRefs-DNAemYUk.js";import{v as w,a as P,C as V}from"./VDialog-IrbBYFLM.js";import{T as N}from"./index-hvGLIBbY.js";import"./VForm-B4hkqnS8.js";const E="Create Covers",Q="Remove Covers",z="Find Orphan Covers",G="Adopt Orphan Folders",W="Create Custom Covers",K="Delete Custom Covers",X="Link Custom Covers",q="Custom Covers Moved",H="Discover Missing Custom Covers",Z="Modify Custom Covers",j="Remove Folders",Y="Move Folders",$="Modify Folders",ee="Create Books",te="Remove Books",se="Record Failed Imports",oe="Move Books",ne="Modify Books",ae="Update First Covers",re="Link Books to Tags",ie="Prepare Tags for Linking",le="Create Missing Tags",ce="Discover Missing Tags",de="Read Book Tags",Ce="Cleanup Orphan Bookmarks",me="Cleanup Custom Covers",Ie="Restart Codex",ue="Stop Codex",pe="Update Codex Software",ke="Backup Database",Se="Optimize Database",he="Search Index Integrity Check",De="Search Index Repair",ve="Database Integrity Check",_e="Database Foreign Key Check",be="Check Codex Latest Version",fe="Cleanup Expired Sessions",Te="Cleanup Stale Tags",Fe="Compress Logs",Le="Search Index Create",Je="Search Index Remove Stale Records",ge="Search Index Optimize",Be="Search Index Update",Me="Search Index Clear",ye="Poll Library",Ae={CCC:E,CCD:Q,CFO:z,IAF:G,ICC:W,ICD:K,ICL:X,ICM:q,ICQ:H,ICU:Z,IDD:j,IDM:Y,IDU:$,IFC:ee,IFD:te,IFI:se,IFM:oe,IFU:ne,IGU:ae,IMC:re,IMQ:ie,ITC:le,ITQ:ce,ITR:de,JCB:Ce,JCD:me,JCR:Ie,JCS:ue,JCU:pe,JDB:ke,JDO:Se,JFC:he,JFR:De,JIC:ve,JIF:_e,JLV:be,JSD:fe,JTD:Te,JCL:Fe,SIC:Le,SID:Je,SIO:ge,SIU:Be,SIX:Me,WPO:ye},Oe={name:"AdminStatusList",components:{CloseButton:R},data(){return{mdiCloseCircleOutline:F}},computed:{...v(I,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{..._(I,["loadTable","librarianTask"]),showComplete:e=>Number.isInteger(e.complete),indeterminate:e=>!e.preactive&&(!e.total||!Number.isInteger(e.complete)),progress(e){return e.preactive||self.indeterminate?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")},title(e){return Ae[e.statusType]},nf(e){return Number.isInteger(e)?L.format(e):"?"}}},xe={key:0},Re={nav:"",class:"statusItem"},Ue={class:"statusItemTitle"},we={key:0,class:"statusItemSubtitle"},Pe={key:1,class:"statusItemSubtitle"},Ve={key:0};function Ne(e,n,l,T,u,t){const c=S("CloseButton");return o(),a(h,null,[e.show?(o(),m(f,{key:0})):i("",!0),r(P,{onClick:t.load},{default:d(()=>[r(D,null,{default:d(()=>[e.show?(o(),a("div",xe,[r(c,{id:"clearButton",title:"Clear Librarian Statuses",size:"small",onClick:t.clear},null,8,["onClick"]),n[0]||(n[0]=p("h4",null,"Librarian Tasks",-1)),(o(!0),a(h,null,J(e.librarianStatuses,s=>(o(),m(D,{key:s.statusType},{default:d(()=>[p("div",Re,[p("div",Ue,[k(C(t.title(s))+" ",1),s.subtitle?(o(),a("div",we,C(s.subtitle),1)):i("",!0),t.showComplete(s)||Number.isInteger(s.total)?(o(),a("div",Pe,[t.showComplete(s)?(o(),a("span",Ve,C(t.nf(s.complete))+" / ",1)):i("",!0),k(" "+C(t.nf(s.total)),1)])):i("",!0)]),r(U,{indeterminate:t.indeterminate(s),"model-value":t.progress(s),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(o(),m(w,{key:1,id:"noTasksRunning"},{default:d(()=>n[1]||(n[1]=[k(" No librarian tasks running ")])),_:1}))]),_:1})]),_:1},8,["onClick"])],64)}const Ee=b(Oe,[["render",Ne],["__scopeId","data-v-0b2eebdc"]]),Qe={name:"AdminMenu",components:{AdminStatusList:Ee,CodexListItem:V},data(){return{mdiOpenInNew:g,mdiDatabaseClockOutline:B,mdiCrownOutline:M}},computed:{...y(A,["isUserAdmin"]),...v(I,["unseenFailedImports"]),failedImportsIcon(){return this.unseenFailedImports?O:void 0},showAdminPanelLink(){var e,n,l;return!((l=(n=(e=this.$router.currentRoute)==null?void 0:e.value)==null?void 0:n.name)!=null&&l.startsWith("admin"))}},methods:{..._(I,["clearFailedImports","librarianTask"]),onPoll(){this.librarianTask("poll")}}},ze={key:0};function Ge(e,n,l,T,u,t){const c=S("CodexListItem"),s=S("AdminStatusList");return e.isUserAdmin?(o(),a("div",ze,[r(f),x(r(c,{title:"Poll All Libraries","prepend-icon":u.mdiDatabaseClockOutline,onClick:t.onPoll},null,8,["prepend-icon","onClick"]),[[N,{openDelay:2e3,text:"for updated comics"}]]),t.showAdminPanelLink?(o(),m(c,{key:0,class:"adminPanelLink",to:{name:"admin"},"prepend-icon":u.mdiCrownOutline,title:"Admin Panel","append-icon":t.failedImportsIcon},null,8,["prepend-icon","append-icon"])):i("",!0),r(s)])):i("",!0)}const et=b(Qe,[["render",Ge]]);export{et as default};
